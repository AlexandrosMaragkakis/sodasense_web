{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    
$(document).ready(function() {
  {% if load_heatmap %}
    // Show loading message for heatmap
    $("#heatmap-container").text("Loading heatmap...");

    // Fetch the heatmap using AJAX
    $.ajax({
      url: "/fetch_chart",
      type: "POST",
      data: JSON.stringify({ chartName: 'heatmap' }),
      contentType: "application/json",
      success: function(data) {
        if (data.filepath) {
          // Replace the loading message with the heatmap file
          $("#heatmap-container").html('<iframe src="' + data.filepath + '"></iframe>');
        } else {
          // Display an error message if the response is invalid
          $("#heatmap-container").html('<p class="error-message">Invalid response received for heatmap.</p>');
        }
      },
      error: function(xhr, status, error) {
        if (xhr.responseJSON && xhr.responseJSON.error) {
          // Display the specific error message for API request failure
          $("#heatmap-container").html('<p class="error-message">Error is: ' + xhr.responseJSON.error + '</p>');
        } else {
          // Display a generic error message for other errors
          $("#heatmap-container").html('<p class="error-message">An error occurred while fetching the heatmap.</p>');
        }
      }
    });
  {% endif %}

  {% if load_timed_heatmap %}
    // Show loading message for timed heatmap
    $("#timed-heatmap-container").text("Loading timed heatmap...");

    // Fetch the timed heatmap using AJAX
    $.ajax({
      url: "/fetch_chart",
      type: "POST",
      data: JSON.stringify({ chartName: 'timed_heatmap' }),
      contentType: "application/json",
      success: function(data) {
        if (data.filepath) {
          // Replace the loading message with the timed heatmap file
          $("#timed-heatmap-container").html('<iframe src="' + data.filepath + '"></iframe>');
        } else {
          // Display an error message if the response is invalid
          $("#timed-heatmap-container").html('<p class="error-message">Invalid response received for timed heatmap.</p>');
        }
      },
      error: function(xhr, status, error) {
        if (xhr.responseJSON && xhr.responseJSON.error) {
          // Display the specific error message for API request failure
          $("#timed-heatmap-container").html('<p class="error-message">Error is: ' + xhr.responseJSON.error + '</p>');
        } else {
          // Display a generic error message for other errors
          $("#timed-heatmap-container").html('<p class="error-message">An error occurred while fetching the timed heatmap.</p>');
        }
      }
    });
  {% endif %}
});

</script>
  
  

  
<div class="main-container">
    <div class="navcontainer">
        <nav class="nav">
            <div class="nav-upper-options">
                <div class="nav-option option1">
                    <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210182148/Untitled-design-(29).png"
                        class="nav-img"
                        alt="dashboard">
                    <h3>Dashboard</h3>
                </div>

                

                <div class="nav-option logout">
                        <img src=
                        "https://media.geeksforgeeks.org/wp-content/uploads/20221210183321/7.png"
                        class="nav-img"
                        alt="logout">
                        <a href="/logout">
                            <h3>Logout</h3>
                        </a>
                </div>

            </div>
        </nav>
    </div>
    <div class="main">

        

        <div class="box-container">

            <div class="box box1">
                <div class="text">
                    <h2 class="topic-heading">60.5k</h2>
                    <h2 class="topic">Article Views</h2>
                </div>

                <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210184645/Untitled-design-(31).png"
                    alt="Views">
            </div>

            <div class="box box2">
                <div class="text">
                    <h2 class="topic-heading">150</h2>
                    <h2 class="topic">Likes</h2>
                </div>

                <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210185030/14.png"
                    alt="likes">
            </div>

            <div class="box box3">
                <div class="text">
                    <h2 class="topic-heading">320</h2>
                    <h2 class="topic">Comments</h2>
                </div>

                <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210184645/Untitled-design-(32).png"
                    alt="comments">
            </div>

            <div class="box box4">
                <div class="text">
                    <h2 class="topic-heading">70</h2>
                    <h2 class="topic">Published</h2>
                </div>

                <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210185029/13.png" alt="published">
            </div>
        </div>

        <div class="report-container">
            <div id="heatmap-container">
                {% if heatmap_file %}
                  <iframe src="{{ heatmap_file }}"></iframe>
                {% endif %}
            </div>
            <div id="timed-heatmap-container">
                {% if timed_heatmap_file %}
                  <iframe src="{{ timed_heatmap_file }}"></iframe>
                {% endif %}
            </div>
            <!-- <iframe src="plotly_graph.html"></iframe>-->
            
        </div>
    </div>
</div>

{% endblock %}
