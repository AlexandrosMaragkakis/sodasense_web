{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    
$(document).ready(function() {
  {% if load_heatmap %}
    // Show loading message for heatmap
    $("#heatmap-container").text("Loading heatmap...");

    // Fetch the heatmap using AJAX

    $.ajax({
      url: "/fetch_chart",
      type: "POST",
      data: JSON.stringify({ chartName: 'heatmap' }),
      contentType: "application/json",
      success: function(data) {
        if (data.success) {
          if (data.filepath) {
            // Replace the loading message with the heatmap file
            $("#heatmap-container").html('<iframe src="' + data.filepath + '"></iframe>');
          } else {
            // Display an error message if the response is invalid
            $("#heatmap-container").html('<p class="error-message">Invalid response received for heatmap.</p>');
          }
        } else {
          // Display a generic error message for server-side errors
          $("#heatmap-container").html('<p class="error-message">An error occurred while fetching the heatmap.</p>');
        }
      },
      error: function(xhr, status, error) {
        // Display a generic error message for client-side errors
        $("#heatmap-container").html('<p class="error-message">An error occurred while making the request.</p>');
      }
    });
  {% endif %}

  {% if load_timed_heatmap %}
    // Show loading message for timed heatmap
    $("#timed-heatmap-container").text("Loading timed heatmap...");

    // Fetch the timed heatmap using AJAX
    $.ajax({
      url: "/fetch_chart",
      type: "POST",
      data: JSON.stringify({ chartName: 'timed_heatmap' }),
      contentType: "application/json",
      success: function(data) {
        if (data.success) {
          if (data.filepath) {
            // Replace the loading message with the heatmap file
            $("#timed-heatmap-container").html('<iframe src="' + data.filepath + '"></iframe>');
          } else {
            // Display an error message if the response is invalid
            $("#timed-heatmap-container").html('<p class="error-message">Invalid response received for timed heatmap.</p>');
          }
        } else {
          // Display a generic error message for server-side errors
          $("#timed-heatmap-container").html('<p class="error-message">An error occurred while fetching the timed heatmap.</p>');
        }
      },
      error: function(xhr, status, error) {
        // Display a generic error message for client-side errors
        $("#timed-heatmap-container").html('<p class="error-message">An error occurred while making the request.</p>');
      }
    });
  {% endif %}
});

</script>
  
  

  
<div class="main-container">
    <div class="navcontainer">
        <nav class="nav">
            <div class="nav-upper-options">
                <div class="nav-option option1">
                    <img src=
"https://media.geeksforgeeks.org/wp-content/uploads/20221210182148/Untitled-design-(29).png"
                        class="nav-img"
                        alt="dashboard">
                    <h3>Dashboard</h3>
                </div>

                

                <div class="nav-option logout">
                        <img src=
                        "https://media.geeksforgeeks.org/wp-content/uploads/20221210183321/7.png"
                        class="nav-img"
                        alt="logout">
                        <a href="/logout">
                            <h3>Logout</h3>
                        </a>
                </div>

            </div>
        </nav>
    </div>
    <div class="main">
        <div class="report-container">
            <div id="heatmap-container">
                {% if heatmap_file %}
                  <iframe src="{{ heatmap_file }}"></iframe>
                {% endif %}
            </div>
            <div id="timed-heatmap-container">
                {% if timed_heatmap_file %}
                  <iframe src="{{ timed_heatmap_file }}"></iframe>
                {% endif %}
            </div>
            <!-- <iframe src="plotly_graph.html"></iframe>-->
            
        </div>
    </div>
</div>

{% endblock %}
